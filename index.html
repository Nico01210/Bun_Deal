<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bun_Deal index</title>
  
  <!-- Favicon -->
  <link rel="icon" href="favicon.svg" type="image/svg+xml">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🍔</text></svg>" type="image/svg+xml">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🍔</text></svg>">`
  
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
       .card-img-top {
      width: 100%;
      height: 400px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.08);
    }
  </style>
</head>
<body class="home-page">

<!-- Overlay pour fermer le menu mobile -->
<div class="nav-overlay"></div>

<!-- Navbar avec menu burger -->
<nav class="menu">
  <div class="navbar-container">
    <a href="/Bun_Deal/index.html" class="logo">
      <img src="images/Logo.png" alt="Logo Bun'Deal" class="logo-navbar">
    </a>
    
    <!-- Menu burger (visible sur mobile/tablette) -->
    <div class="burger-menu">
      <span></span>
      <span></span>
      <span></span>
    </div>
    
    <!-- Navigation links -->
    <ul class="nav-links">
      <li><a href="/Bun_Deal/index.html" data-translate="nav.home">Accueil</a></li>
      <li><a href="/Bun_Deal/apropos.html" data-translate="nav.about">A propos</a></li>
      <li><a href="/Bun_Deal/menu.html" data-translate="nav.menu">Menu</a></li>
      <li><a href="/Bun_Deal/Contact.html" data-translate="nav.contact">Contact</a></li>
      <li><a href="#" id="open-cart" style="font-weight:bold;">🛒 <span data-translate="nav.cart">Panier</span> (<span id="cart-count">0</span>)</a></li>
      <li>
        <button id="lang-toggle" class="btn btn-outline-light btn-sm">
          <img src="images/flag-en.svg" alt="English" style="width: 16px; height: 12px; margin-right: 4px;">
          EN
        </button>
      </li>
    </ul>
  </div>
</nav>


<!-- HERO SECTION -->
<section class="hero">
  <div class="hero-content">
    <h1 data-translate="hero.title">Bienvenue chez Bun'Deal</h1>
    <p data-translate="hero.subtitle">Des burgers frais, savoureux et servis en un éclair !</p>
    <a href="/Bun_Deal/menu.html" class="btn-order" data-translate="hero.cta">Voir le menu</a>
  </div>
</section>

<!-- CONTENU PRINCIPAL -->
<div class="container my-5">
  <h2 class="text-center mb-4" data-translate="bestsellers.title">Nos Best-Sellers</h2>
  <div class="row g-4 justify-content-center">
    <!-- Carte 1 -->
    <div class="col-md-4">
      <div class="card h-100 shadow">
        <img src="images/Special-burger.png" width=400px height=350px class="card-img-top" alt="Burger Spécial">
        <div class="card-body text-center">
          <h5 class="card-title" data-translate="bestsellers.burger_special.title">Burger Spécial</h5>
          <p class="card-text" data-translate="bestsellers.burger_special.description">Pain brioche maison, double steak haché de bœuf Black Angus 2x150g, salade, tomate, cornichons, oignon rouge, double cheddar affiné et notre sauce burger maison.</p>
          <p class="fw-bold text-success">9,50 €</p>
          <a href="#" class="btn btn-primary add-to-cart" 
             data-name="Burger Spécial" 
             data-price="9.50" 
             data-img="images/burger.jpg"
             data-translate="bestsellers.add_to_cart">Ajouter au panier</a>
        </div>
      </div>
    </div>
    <!-- Carte 2 -->
    <div class="col-md-4">
      <div class="card h-100 shadow">
        <img src="images/tacos.jpg" width=400px height=350px class="card-img-top" alt="Tacos">
        <div class="card-body text-center">
          <h5 class="card-title" data-translate="bestsellers.menu_tacos.title">Menu Tacos</h5>
          <p class="card-text" data-translate="bestsellers.menu_tacos.description">Garniture au choix, sauce fromagère et frites incluses.</p>
          <p class="fw-bold text-success">10,50 €</p>
          <button class="btn btn-primary" id="open-taco-modal" data-translate="bestsellers.add_to_cart">Ajouter au panier</button>
        </div>
      </div>
    </div>
    <!-- Carte 3 -->
    <div class="col-md-4">
      <div class="card h-100 shadow">
        <img src="images/Menu-enfant.jpg" width=400px height=350px class="card-img-top" alt="Menu Enfant">
        <div class="card-body text-center">
          <h5 class="card-title" data-translate="bestsellers.menu_enfant.title">Menu Enfant</h5>
          <p class="card-text" data-translate="bestsellers.menu_enfant.description">Mini burger, frites et jus de fruits. Jouet offert !</p>
          <p class="fw-bold text-success">6,50 €</p>
          <button class="btn btn-primary" id="open-child-modal" data-translate="bestsellers.add_to_cart">Ajouter au panier</button>
        </div>
      </div>
    </div>
    <!-- Carte 4 -->
    <div class="col-md-4">
      <div class="card h-100 shadow">
        <img src="images/mixed-tacos.jpg" width=400px height=350px class="card-img-top" alt="Tacos-Mixed">
        <div class="card-body text-center">
          <h5 class="card-title" data-translate="bestsellers.assiette_tapas.title">Tacos Mixed</h5>
          <p class="card-text" data-translate="bestsellers.assiette_tapas.description">Formule pour vos soirées ou apéros. Choix de 7 Tacos parmi notre sélection de tacos !</p>
          <p class="fw-bold text-success">45,50€</p>
          <button class="btn btn-primary" id="open-tapas-modal" data-translate="bestsellers.add_to_cart">Ajouter au panier</button>
        </div>
      </div>
    </div>
    <!-- Carte 5 -->
    <div class="col-md-4">
      <div class="card h-100 shadow">
        <img src="images/tenders.jpg" width=400px height=350px class="card-img-top" alt="Tenders">
        <div class="card-body text-center">
          <h5 class="card-title" data-translate="bestsellers.tenders.title">Tenders de poulet</h5>
          <p class="card-text" data-translate="bestsellers.tenders.description">4 Tenders de poulet pané maison avec épices, sésames et ciboulette</p>
          <p class="fw-bold text-success">3,50 €</p>
          <a href="#" class="btn btn-primary add-to-cart" 
             data-name="Tenders de poulet" 
             data-price="3.50" 
             data-img="images/tenders.jpg"
             data-translate="bestsellers.add_to_cart">Ajouter au panier</a>
        </div>
      </div>
    </div>
  </div>
</div>

<article class="container" id="pourquoi-nous">
    <img src="images/produits.jpg" alt="Produits locaux" class="product-img">
    <h2 data-translate="about.title">POURQUOI NOUS ?</h2>
    <p data-translate="about.text">Chez Bun'deal, on ne fait pas de compromis entre goût, qualité et engagement.<br>
Notre promesse : une cuisine fraîche, faite maison, avec des ingrédients locaux et de qualité. Chaque bun, chaque garniture, chaque sauce est préparé avec soin, dans notre cuisine, à partir de produits bruts issus de producteurs locaux sélectionnés pour leur savoir-faire et leur respect de la terre.<br>

En choisissant Bun'deal, vous soutenez une entreprise qui agit concrètement pour le développement du terroir et de notre région. Vous encouragez une économie plus responsable, plus humaine et plus savoureuse.<br>

Bun'deal, c’est bien plus qu’un repas : c’est un deal gagnant entre vous, la planète, et nos producteurs. </p>
</article>

<div class="container my-5">
  <h2 class="text-center mb-4" data-translate="testimonials.title">Ce que nos clients disent de nous</h2>
  <div class="row g-4">
    <div class="col-md-4">
      <div class="testimonial-card">
        <div class="stars">★★★★★</div>
        <p class="quote" data-translate="testimonials.review1">"Les burgers sont incroyables ! Le pain est moelleux, la viande est juteuse et la sauce maison... un délice !"</p>
        <p class="author">— Camille R.</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="testimonial-card">
        <div class="stars">★★★★☆</div>
        <p class="quote" data-translate="testimonials.review2">"Livraison rapide et super chaude à l'arrivée. Les frites sont croustillantes, rien à redire."</p>
        <p class="author">— Mehdi L.</p>
      </div>
    </div>
    <div class="col-md-4">
      <div class="testimonial-card">
        <div class="stars">★★★★★</div>
        <p class="quote" data-translate="testimonials.review3">"Le menu enfant est parfait pour mes petits. Ils adorent et moi aussi ! Et en plus, le jouet est trop mignon."</p>
        <p class="author">— Sarah D.</p>
      </div>
    </div>
  </div>
</div>


<!-- Footer -->
<div class="footer-clean bg-light pt-4">
  <footer>
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-sm-4 col-md-3 item">
          <h3 data-translate="footer.services">Services</h3>
          <ul>
            <li><a href="menu.html" data-translate="nav.menu">Menu</a></li>
            <li><a href="Contact.html" data-translate="footer.events">Évènements</a></li>
            <li><a href="Contact.html" data-translate="footer.special_orders">Commandes spéciales</a></li>
          </ul>
        </div>
        <div class="col-sm-4 col-md-3 item">
          <h3 data-translate="footer.about">About</h3>
          <ul>
            <li><a href="apropos.html" data-translate="footer.company">Company</a></li>
            <li><a href="apropos.html" data-translate="footer.team">Team</a></li>
            <li><a href="apropos.html" data-translate="footer.legacy">Legacy</a></li>
          </ul>
        </div>
        <div class="col-sm-4 col-md-3 item">
          <h3 data-translate="footer.contact">Contact</h3>
          <ul>
            <li><a href="Contact.html" data-translate="footer.contact_us">Nous contacter</a></li>
            <li><a href="Contact.html" data-translate="footer.join_us">Nous rejoindre</a></li>
            <li><a href="apropos.html" data-translate="footer.find_us">Nous trouver</a></li>
          </ul>
        </div>
        <div class="col-lg-3 item social text-center">
          <a href="#"><img src="images/FB.webp" alt="Facebook" class="footer-social-logo"></a>
          <a href="#"><img src="images/twitter.png" alt="Twitter" class="footer-social-logo"></a>
          <a href="#"><img src="images/snapchat.webp" alt="Snapchat" class="footer-social-logo"></a>
          <a href="#"><img src="images/insta.png" alt="Instagram" class="footer-social-logo"></a>
          <p class="copyright mt-2" data-translate="footer.copyright">Bun'Deal © 2025</p>
        </div>
      </div>
    </div>
  </footer>
</div>

<!-- Modal panier -->
<div class="modal" tabindex="-1" id="cart-modal">
  <div style="background:#fff; margin:5% auto; padding:20px; max-width:500px; border-radius:8px; position:relative;">
    <button id="close-cart" style="position:absolute; top:8px; right:8px; background:none; border:none; font-size:28px; cursor:pointer; color:#666; line-height:1; width:30px; height:30px; display:flex; align-items:center; justify-content:center;" title="Fermer">&times;</button>
    <h4 data-translate="modals.cart.title">Votre panier</h4>
    <ul id="cart-items" style="list-style:none; padding:0;"></ul>
    <p><span data-translate="modals.cart.total">Total</span> : <span id="cart-total">0.00</span> €</p>
    <div class="mt-3" style="display: flex; justify-content: space-between; align-items: center; gap: 10px;">
      <button class="btn btn-danger" id="clear-cart" data-translate="modals.cart.clear" style="width: 30% !important; padding: 10px 15px !important; white-space: nowrap !important; font-size: 14px !important;">Vider le panier</button>
      <button class="btn btn-success" id="validate-cart" data-translate="modals.cart.validate" style="width: 65% !important; padding: 10px 15px !important; white-space: nowrap !important; font-size: 14px !important; box-sizing: border-box !important;">Valider le panier</button>
    </div>
  </div>
</div>

<!-- Modal choix menu (réutilisable pour Menu Tacos et Menu Enfant) -->
<div class="modal" tabindex="-1" id="menu-choice-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:9999;">
  <div class="cart-modal-content" style="max-width:400px;">
    <h4 data-translate="modals.menu_choice.title">Choisissez votre burger et boisson</h4>
    <form id="menu-choice-form">
      <div class="mb-3">
        <label for="burger-choice" class="form-label" data-translate="modals.menu_choice.burger_label">Burger/Tacos</label>
        <select id="burger-choice" class="form-select" required>
          <!-- Options générées dynamiquement selon le type de menu -->
        </select>
      </div>
      <div class="mb-3">
        <label for="boisson-choice" class="form-label" data-translate="modals.menu_choice.drink_label">Boisson</label>
        <select id="boisson-choice" class="form-select" required>
          <!-- Options générées par JavaScript -->
        </select>
      </div>
      <button type="submit" class="btn btn-primary w-100" data-translate="modals.menu_choice.add_button">Ajouter au panier</button>
      <button type="button" class="btn btn-secondary w-100 mt-2" id="close-menu-choice" data-translate="modals.menu_choice.cancel_button">Annuler</button>
    </form>
  </div>
</div>

<!-- Modal choix assiette tapas (garde celle-ci car elle est spécifique) -->
<div class="modal" tabindex="-1" id="tapas-choice-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:9999;">
  <div style="background:#fff; margin:3% auto; padding:30px; max-width:500px; border-radius:12px; position:relative;">
    <h4 class="text-center mb-4" data-translate="modals.tapas.title">Composez votre Assiette Tacos</h4>
    <p class="text-center text-muted mb-4" data-translate="modals.tapas.subtitle">Choisissez 7 tacos parmi nos garnitures</p>
    
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label fw-bold" data-translate="modals.tapas.labels.poulet">Tacos Poulet :</label>
        <select class="form-select" id="tapas-poulet">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
        </select>
      </div>
      <div class="col-md-6">
        <label class="form-label fw-bold" data-translate="modals.tapas.labels.boeuf">Tacos Bœuf :</label>
        <select class="form-select" id="tapas-boeuf">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
        </select>
      </div>
      <div class="col-md-6">
        <label class="form-label fw-bold" data-translate="modals.tapas.labels.poisson">Tacos Poisson :</label>
        <select class="form-select" id="tapas-poisson">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
        </select>
      </div>
      <div class="col-md-6">
        <label class="form-label fw-bold" data-translate="modals.tapas.labels.agneau">Tacos Agneau :</label>
        <select class="form-select" id="tapas-agneau">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
        </select>
      </div>
    </div>
    
    <div class="alert alert-info mt-3" id="tapas-counter">
      <small><span data-translate="modals.tapas.counter">Total sélectionné :</span> <span id="tapas-total">0</span>/7 <span data-translate="modals.tapas.tacos">tacos</span></small>
    </div>
    
    <div class="text-center">
      <button class="btn btn-primary me-2" id="add-tapas-to-cart" disabled data-translate="modals.tapas.add">Ajouter au panier</button>
      <button class="btn btn-secondary" id="close-tapas-modal" data-translate="modals.tapas.cancel">Annuler</button>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>
<script>
// Script de traduction
let currentLang = localStorage.getItem('language') || 'fr';
let translations = {};

// Charge les traductions
async function loadTranslations() {
  try {
    const response = await fetch('translations.json');
    translations = await response.json();
    updateLanguage();
  } catch (error) {
    console.error('Erreur lors du chargement des traductions:', error);
  }
}

// Met à jour tous les textes selon la langue
function updateLanguage() {
  const langButton = document.getElementById('lang-toggle');
  
  // Met à jour le bouton de langue avec les drapeaux
  if (currentLang === 'fr') {
    langButton.innerHTML = '<img src="images/flag-en.svg" alt="English" style="width: 16px; height: 12px; margin-right: 4px;"> EN';
  } else {
    langButton.innerHTML = '<img src="images/flag-fr.svg" alt="Français" style="width: 16px; height: 12px; margin-right: 4px;"> FR';
  }
  
  // Met à jour tous les éléments avec data-translate
  document.querySelectorAll('[data-translate]').forEach(element => {
    const key = element.getAttribute('data-translate');
    const text = getTranslation(key);
    if (text) {
      element.textContent = text;
    }
  });
  
  // Met à jour les modales ouvertes
  updateOpenModals();
  
  // Met à jour le panier si il est ouvert
  const cartModal = document.getElementById('cart-modal');
  if (cartModal && cartModal.style.display === 'block') {
    renderCart();
  }
}

// Récupère une traduction par clé
function getTranslation(key) {
  const keys = key.split('.');
  let value = translations[currentLang];
  
  for (const k of keys) {
    if (value && value[k]) {
      value = value[k];
    } else {
      return null;
    }
  }
  
  return value;
}

// Gestion du changement de langue
document.addEventListener('DOMContentLoaded', function() {
  loadTranslations();
  updateCartCount();
  
  // Initialise les selects une fois les traductions chargées
  setTimeout(() => {
    updateSelectOptions();
  }, 100);
  
  document.getElementById('lang-toggle').addEventListener('click', function() {
    currentLang = currentLang === 'fr' ? 'en' : 'fr';
    localStorage.setItem('language', currentLang);
    updateLanguage();
  });
});

// Gestion du panier et des modales
function getCart() {
  return JSON.parse(localStorage.getItem('cart') || '[]');
}

function setCart(cart) {
  localStorage.setItem('cart', JSON.stringify(cart));
  updateCartCount();
}

function updateCartCount() {
  const cart = getCart();
  const el = document.getElementById('cart-count');
  if (el) el.textContent = cart.reduce((sum, item) => sum + item.qty, 0);
}

function renderCart() {
  const cart = getCart();
  const list = document.getElementById('cart-items');
  list.innerHTML = '';
  let total = 0;
  
  cart.forEach((item, idx) => {
    total += item.price * item.qty;
    
    // Traduit le nom du produit selon la langue actuelle
    let translatedName = item.name;
    if (item.translationKey) {
      const translation = getTranslation(item.translationKey);
      if (translation) {
        translatedName = translation;
        
        // Ajoute les choix spécifiques s'ils existent
        if (item.choices) {
          const translatedChoices = item.choices.map(choice => {
            if (choice.translationKey) {
              return getTranslation(choice.translationKey) || choice.value;
            }
            return choice.value;
          });
          translatedName += ` (${translatedChoices.join(', ')})`;
        }
      }
    }
    
    const removeText = getTranslation('modals.cart.remove') || 'Supprimer';
    
    const li = document.createElement('li');
    li.innerHTML = `
      <img src="${item.img}" width="40" style="vertical-align:middle;"> 
      ${translatedName} x${item.qty} - ${(item.price * item.qty).toFixed(2)} €
      <button class="btn btn-sm btn-danger" onclick="removeFromCart(${idx})">${removeText}</button>
    `;
    list.appendChild(li);
  });
  
  document.getElementById('cart-total').textContent = total.toFixed(2);
}

function removeFromCart(idx) {
  const cart = getCart();
  cart.splice(idx, 1);
  setCart(cart);
  renderCart();
}

// Remplace les event listeners add-to-cart par :

document.querySelectorAll('.add-to-cart').forEach(btn => {
  btn.addEventListener('click', function(e) {
    e.preventDefault();
    const name = this.dataset.name;
    const price = parseFloat(this.dataset.price);
    const img = this.dataset.img;
    
    // Détermine la clé de traduction selon le produit
    let translationKey = getTranslationKeyForProduct(name);
    
    let cart = getCart();
    const found = cart.find(item => item.name === name && item.translationKey === translationKey);
    if (found) {
      found.qty += 1;
    } else {
      cart.push({
        name, 
        price, 
        img, 
        qty: 1,
        translationKey: translationKey
      });
    }
    setCart(cart);
  });
});

document.getElementById('open-taco-modal').onclick = function(e) {
  e.preventDefault();
  document.getElementById('menu-choice-modal').style.display = 'block';
  
  window.selectedMenu = {
    name: 'Menu Tacos',
    price: 10.50,
    img: 'images/tacos.jpg'
  };
  
  // Applique immédiatement les traductions
  setTimeout(() => {
    updateMenuChoices();
  }, 10);
};

document.getElementById('open-child-modal').onclick = function(e) {
  e.preventDefault();
  document.getElementById('menu-choice-modal').style.display = 'block';
  
  window.selectedMenu = {
    name: 'Menu Enfant',
    price: 6.50,
    img: 'images/Menu-enfant.jpg'
  };
  
  // Applique immédiatement les traductions
  setTimeout(() => {
    updateMenuChoices();
  }, 10);
};

document.getElementById('close-menu-choice').onclick = function() {
  document.getElementById('menu-choice-modal').style.display = 'none';
};

// Remplace le gestionnaire menu-choice-form par :

document.getElementById('menu-choice-form').onsubmit = function(e) {
  e.preventDefault();
  
  const burgerSelect = document.getElementById('burger-choice');
  const drinkSelect = document.getElementById('boisson-choice');
  
  const burgerValue = burgerSelect.value;
  const drinkValue = drinkSelect.value;
  
  if (!burgerValue || !drinkValue) {
    alert('Veuillez sélectionner tous les éléments');
    return;
  }
  
  // Détermine la clé de traduction du menu
  let menuTranslationKey = getTranslationKeyForProduct(window.selectedMenu.name);
  
  // Créé les choix avec leurs clés de traduction
  const choices = [
    {
      value: burgerValue,
      translationKey: getBurgerTranslationKey(burgerValue)
    },
    {
      value: drinkValue,
      translationKey: `modals.menu_choice.drinks.${drinkValue}`
    }
  ];
  
  let cart = getCart();
  cart.push({
    name: window.selectedMenu.name,
    price: window.selectedMenu.price,
    img: window.selectedMenu.img,
    qty: 1,
    translationKey: menuTranslationKey,
    choices: choices
  });
  setCart(cart);
  
  // Ferme la modale après ajout
  document.getElementById('menu-choice-modal').style.display = 'none';
};

function getBurgerTranslationKey(burgerValue) {
  const burgerMap = {
    'cheeseburger': 'modals.menu_choice.kid_menu.choices.cheeseburger',
    'nuggets': 'modals.menu_choice.kid_menu.choices.nuggets',
    'tacos_poulet': 'modals.menu_choice.burger_choices.tacos_poulet',
    'tacos_boeuf': 'modals.menu_choice.burger_choices.tacos_boeuf',
    'tacos_poisson': 'modals.menu_choice.burger_choices.tacos_poisson',
    'tacos_agneau': 'modals.menu_choice.burger_choices.tacos_agneau'
  };
  
  return burgerMap[burgerValue] || null;
}

document.getElementById('open-cart').onclick = function(e) {
  e.preventDefault();
  document.getElementById('cart-modal').style.display = 'block';
  renderCart();
};

document.getElementById('close-cart').onclick = function() {
  document.getElementById('cart-modal').style.display = 'none';
};

// Fermer le panier en cliquant en dehors
document.getElementById('cart-modal').onclick = function(e) {
  if (e.target === this) {
    this.style.display = 'none';
  }
};

document.getElementById('clear-cart').onclick = function() {
  setCart([]);
  renderCart();
};

document.getElementById('open-tapas-modal').onclick = function(e) {
  e.preventDefault();
  document.getElementById('tapas-choice-modal').style.display = 'block';
  updateTapasCounter();
};

document.getElementById('close-tapas-modal').onclick = function() {
  document.getElementById('tapas-choice-modal').style.display = 'none';
};

function updateTapasCounter() {
  const poulet = parseInt(document.getElementById('tapas-poulet').value);
  const boeuf = parseInt(document.getElementById('tapas-boeuf').value);
  const poisson = parseInt(document.getElementById('tapas-poisson').value);
  const agneau = parseInt(document.getElementById('tapas-agneau').value);
  
  const total = poulet + boeuf + poisson + agneau;
  document.getElementById('tapas-total').textContent = total;
  
  const addButton = document.getElementById('add-tapas-to-cart');
  if (total === 7) {
    addButton.disabled = false;
    addButton.classList.remove('btn-secondary');
    addButton.classList.add('btn-primary');
  } else {
    addButton.disabled = true;
    addButton.classList.remove('btn-primary');
    addButton.classList.add('btn-secondary');
  }
}

// Écouter les changements sur tous les selects
['tapas-poulet', 'tapas-boeuf', 'tapas-poisson', 'tapas-agneau'].forEach(id => {
  document.getElementById(id).addEventListener('change', updateTapasCounter);
});

// Remplace le gestionnaire add-tapas-to-cart par :

document.getElementById('add-tapas-to-cart').onclick = function() {
  const poulet = parseInt(document.getElementById('tapas-poulet').value);
  const boeuf = parseInt(document.getElementById('tapas-boeuf').value);
  const poisson = parseInt(document.getElementById('tapas-poisson').value);
  const agneau = parseInt(document.getElementById('tapas-agneau').value);
  
  let choices = [];
  if (poulet > 0) choices.push({
    value: `${poulet} Poulet`,
    translationKey: 'modals.tapas.labels.poulet',
    count: poulet
  });
  if (boeuf > 0) choices.push({
    value: `${boeuf} Bœuf`,
    translationKey: 'modals.tapas.labels.boeuf',
    count: boeuf
  });
  if (poisson > 0) choices.push({
    value: `${poisson} Poisson`,
    translationKey: 'modals.tapas.labels.poisson',
    count: poisson
  });
  if (agneau > 0) choices.push({
    value: `${agneau} Agneau`,
    translationKey: 'modals.tapas.labels.agneau',
    count: agneau
  });
  
  const name = 'Tacos Mixed';
  const price = 45.50;
  const img = 'images/mixed-tacos.jpg';
  
  let cart = getCart();
  cart.push({
    name,
    price,
    img,
    qty: 1,
    translationKey: 'bestsellers.assiette_tapas.title',
    choices: choices
  });
  setCart(cart);
  
  // Ferme la modale après ajout
  document.getElementById('tapas-choice-modal').style.display = 'none';
  
  // Remet à zéro les sélections
  ['tapas-poulet', 'tapas-boeuf', 'tapas-poisson', 'tapas-agneau'].forEach(id => {
    document.getElementById(id).value = '0';
  });
  updateTapasCounter();
};

document.getElementById('validate-cart').onclick = function() {
  const cart = getCart();
  if (cart.length === 0) {
    alert('Votre panier est vide !');
    return;
  }
  
  // Sauvegarde le panier pour la page de commandes
  localStorage.setItem('orderToConfirm', JSON.stringify(cart));
  
  // Redirige vers la page de commandes (avec majuscule)
  window.location.href = 'Commandes.html';
};

// Ajoute ces fonctions dans le script de index.html

function updateMenuChoices() {
  const modal = document.getElementById('menu-choice-modal');
  if (modal && modal.style.display === 'block') {
    const title = modal.querySelector('h4');
    const burgerLabel = modal.querySelector('label[for="burger-choice"]');
    const drinkLabel = modal.querySelector('label[for="boisson-choice"]');
    const submitBtn = modal.querySelector('button[type="submit"]');
    const cancelBtn = modal.querySelector('#close-menu-choice');
    const burgerSelect = modal.querySelector('#burger-choice');
    const drinkSelect = modal.querySelector('#boisson-choice');
    
    // Traduit le titre selon le type de menu
    if (title) {
      if (window.selectedMenu && window.selectedMenu.name === 'Menu Enfant') {
        title.textContent = getTranslation('modals.menu_choice.kid_menu.title') || 'Choisissez votre plat et boisson';
        if (burgerLabel) {
          burgerLabel.textContent = getTranslation('modals.menu_choice.kid_menu.dish_label') || 'Plat';
        }
      } else {
        title.textContent = getTranslation('modals.menu_choice.title') || 'Choisissez votre burger et boisson';
        if (burgerLabel) {
          burgerLabel.textContent = getTranslation('modals.menu_choice.burger_label') || 'Burger/Tacos';
        }
      }
    }
    
    // Traduit les labels
    if (drinkLabel) {
      drinkLabel.textContent = getTranslation('modals.menu_choice.drink_label') || 'Boisson';
    }
    
    // Traduit les boutons
    if (submitBtn) {
      submitBtn.textContent = getTranslation('modals.menu_choice.add_button') || 'Ajouter au panier';
    }
    if (cancelBtn) {
      cancelBtn.textContent = getTranslation('modals.menu_choice.cancel_button') || 'Annuler';
    }
    
    // Traduit les options des selects
    if (burgerSelect && drinkSelect) {
      const burgerCurrentValue = burgerSelect.value;
      const drinkCurrentValue = drinkSelect.value;
      
      // Options selon le type de menu
      if (window.selectedMenu && window.selectedMenu.name === 'Menu Enfant') {
        const dishPlaceholder = getTranslation('modals.menu_choice.kid_menu.dish_placeholder') || 'Sélectionnez un plat';
        const cheeseburgerText = getTranslation('modals.menu_choice.kid_menu.choices.cheeseburger') || 'Cheeseburger de boeuf';
        const nuggetsText = getTranslation('modals.menu_choice.kid_menu.choices.nuggets') || '6 Nuggets de poulet';
        
        burgerSelect.innerHTML = `
          <option value="">${dishPlaceholder}</option>
          <option value="cheeseburger">${cheeseburgerText}</option>
          <option value="nuggets">${nuggetsText}</option>
        `;
      } else {
        // Menu Tacos : seulement les garnitures
        const garniturePlaceholder = getTranslation('modals.menu_choice.burger_placeholder') || 'Sélectionnez une garniture';
        const pouletText = getTranslation('modals.menu_choice.burger_choices.tacos_poulet') || 'Tacos de Poulet';
        const boeufText = getTranslation('modals.menu_choice.burger_choices.tacos_boeuf') || 'Tacos de Boeuf';
        const poissonText = getTranslation('modals.menu_choice.burger_choices.tacos_poisson') || 'Tacos de Poisson';
        const agneauText = getTranslation('modals.menu_choice.burger_choices.tacos_agneau') || 'Tacos d\'Agneau';
        
        burgerSelect.innerHTML = `
          <option value="">${garniturePlaceholder}</option>
          <option value="tacos_poulet">${pouletText}</option>
          <option value="tacos_boeuf">${boeufText}</option>
          <option value="tacos_poisson">${poissonText}</option>
          <option value="tacos_agneau">${agneauText}</option>
        `;
      }
      
      // Traduit les boissons (identique pour tous)
      const drinkPlaceholder = getTranslation('modals.menu_choice.drink_placeholder') || 'Sélectionnez une boisson';
      const cocaColaText = getTranslation('modals.menu_choice.drinks.coca_cola') || 'Coca-Cola';
      const oasisText = getTranslation('modals.menu_choice.drinks.oasis') || 'Oasis';
      const iceTeaText = getTranslation('modals.menu_choice.drinks.ice_tea') || 'Lipton Ice Tea pêche';
      const spriteText = getTranslation('modals.menu_choice.drinks.sprite') || 'Sprite';
      const fantaText = getTranslation('modals.menu_choice.drinks.fanta') || 'Fanta';
      const eauMineraleText = getTranslation('modals.menu_choice.drinks.eau_minerale') || 'Eau minérale';
      const eauGazeuseText = getTranslation('modals.menu_choice.drinks.eau_gazeuse') || 'Eau gazeuse';
      const cocaZeroText = getTranslation('modals.menu_choice.drinks.coca_zero') || 'Coca-Cola Zéro';
      const jusOrangeText = getTranslation('modals.menu_choice.drinks.jus_orange') || 'Jus d\'orange';
      const jusPommeText = getTranslation('modals.menu_choice.drinks.jus_pomme') || 'Jus de Pomme';
      
      drinkSelect.innerHTML = `
        <option value="">${drinkPlaceholder}</option>
        <option value="coca_cola">${cocaColaText}</option>
        <option value="oasis">${oasisText}</option>
        <option value="ice_tea">${iceTeaText}</option>
        <option value="sprite">${spriteText}</option>
        <option value="fanta">${fantaText}</option>
        <option value="eau_minerale">${eauMineraleText}</option>
        <option value="eau_gazeuse">${eauGazeuseText}</option>
        <option value="coca_zero">${cocaZeroText}</option>
        <option value="jus_orange">${jusOrangeText}</option>
        <option value="jus_pomme">${jusPommeText}</option>
      `;
      
      // Restaure les valeurs sélectionnées
      burgerSelect.value = burgerCurrentValue;
      drinkSelect.value = drinkCurrentValue;
    }
  }
}

function updateOpenModals() {
  // Met à jour la modale menu si elle est ouverte
  const menuModal = document.getElementById('menu-choice-modal');
  if (menuModal && menuModal.style.display === 'block') {
    updateMenuChoices();
  }
  
  // Met à jour la modale tapas si elle est ouverte
  const tapasModal = document.getElementById('tapas-choice-modal');
  if (tapasModal && tapasModal.style.display === 'block') {
    // Pas d'options à mettre à jour pour les tapas
  }
}

// Ajoute cette fonction dans le script :

function getTranslationKeyForProduct(productName) {
  const productMap = {
    // Best-sellers index.html
    'Burger Spécial': 'bestsellers.burger_special.title',
    'Menu Tacos': 'bestsellers.menu_tacos.title',
    'Menu Enfant': 'bestsellers.menu_enfant.title',
    'Tacos Mixed': 'bestsellers.assiette_tapas.title',
    'Tenders de poulet': 'bestsellers.tenders.title',
    
    // Burgers menu.html
    'Burger Boeuf': 'menu.burgers.boeuf.title',
    'Burger Poulet': 'menu.burgers.poulet.title',
    'Burger Poisson': 'menu.burgers.poisson.title',
    'Burger Montagnard': 'menu.burgers.montagnard.title',
    'Burger Pulled-pork': 'menu.burgers.pulled_pork.title',
    'Burger Végétarien': 'menu.burgers.vegetarien.title',
    'Smash Burger': 'menu.burgers.smash.title',
    
    // Tacos menu.html
    'Tacos de Boeuf': 'menu.tacos.beef.title',
    'Tacos de Poulet': 'menu.tacos.chicken.title',
    'Tacos de Poisson': 'menu.tacos.fish.title',
    'Tacos d\'Agneau': 'menu.tacos.lamb.title',
    
    // Snacks menu.html
    'Frites': 'menu.snacks.frites.title',
    'Nuggets de poulet': 'menu.snacks.nuggets.title',
    'Onion Rings': 'menu.snacks.onion_rings.title',
    
    // Boissons menu.html
    'Oasis': 'menu.drinks.oasis.title',
    'Coca-Cola': 'menu.drinks.coca_cola.title',
    'Lipton Ice Tea pêche': 'menu.drinks.ice_tea.title',
    'Sprite': 'menu.drinks.sprite.title',
    'Fanta': 'menu.drinks.fanta.title',
    'Eau minéral': 'menu.drinks.eau_minerale.title',
    'Eau gazeuse': 'menu.drinks.eau_gazeuse.title',
    'Coca-Cola Zéro': 'menu.drinks.coca_zero.title',
    'Jus d\'orange': 'menu.drinks.jus_orange.title',
    'Jus de Pomme': 'menu.drinks.jus_pomme.title',
    'Bière Blonde': 'menu.drinks.biere_blonde.title',
    'Bière Brune': 'menu.drinks.biere_brune.title',
    
    // Desserts menu.html
    'Tiramisu': 'menu.desserts.tiramisu.title',
    'Brownie': 'menu.desserts.brownie.title',
    'Yaourt à Boire': 'menu.desserts.yaourt.title',
    'Gaufre': 'menu.desserts.gaufre.title',
    'Salade de Fruits': 'menu.desserts.salade_fruits.title',
    
    // Menus menu.html
    'Menu enfant': 'menu.menus.enfant.title',
    'Menu Small': 'menu.menus.small.title',
    'Menu XL': 'menu.menus.xl.title'
  };
  
  return productMap[productName] || null;
}
</script>

<script>
window.addEventListener('scroll', function() {
  const navbar = document.querySelector('.menu');
  // Change ici la valeur (ex: 80) selon la hauteur de ton hero ou du scroll souhaité
  if(window.scrollY > 80) {
    navbar.classList.add('navbar-colored');
  } else {
    navbar.classList.remove('navbar-colored');
  }
});
</script>

<script src="burger-menu.js"></script>
</body>
</html>
